<script>document.write(decodeURIComponent(escape(atob("PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+CjxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsaW5pdGlhbC1zY2FsZT0xIi8+Cjx0aXRsZT5VbmlmaWVkIEJ1bGsgU2NhbiDigJQgRG9tYWlucywgSGFzaGVzICYgSVBzPC90aXRsZT4KPHN0eWxlPgogIDpyb290IHsgLS1iZzojMGYxMTEzOyAtLWNhcmQ6IzE2MTgxYjsgLS1ib3JkZXI6IzI2MjsgLS1tdXRlZDojYmZiZmJmOyAtLWFjY2VudDojMmVhM2ZmOyAtLWdvb2Q6I2M4ZjdjNTsgLS13YXJuOiNmZmYwYzI7IC0tYmFkOiNmZmQ2ZDY7IGNvbG9yLXNjaGVtZTogZGFyazsgfQogIGJvZHkgeyBmb250LWZhbWlseTogc3lzdGVtLXVpLC1hcHBsZS1zeXN0ZW0sU2Vnb2UgVUksUm9ib3RvLEFyaWFsOyBiYWNrZ3JvdW5kOiB2YXIoLS1iZyk7IGNvbG9yOiAjZWVlOyBtYXJnaW46IDA7IHBhZGRpbmc6IDIwcHg7IH0KICAud3JhcCB7IG1heC13aWR0aDogMTIwMHB4OyBtYXJnaW46IDAgYXV0bzsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgNDIwcHg7IGdhcDogMThweDsgYWxpZ24taXRlbXM6IHN0YXJ0OyB9CiAgLmNhcmQgeyBiYWNrZ3JvdW5kOiB2YXIoLS1jYXJkKTsgcGFkZGluZzogMTJweDsgYm9yZGVyLXJhZGl1czogOHB4OyBib3gtc2hhZG93OiAwIDZweCAxOHB4IHJnYmEoMCwwLDAsMC42KTsgfQogIGgxLGgyLGgzIHsgbWFyZ2luOiAwIDAgMTJweCAwOyBkaXNwbGF5OmZsZXg7IGFsaWduLWl0ZW1zOmNlbnRlcjsgZ2FwOjhweDsgfQogIHRleHRhcmVhLCBpbnB1dCwgc2VsZWN0IHsgd2lkdGg6MTAwJTsgcGFkZGluZzo4cHg7IGJvcmRlci1yYWRpdXM6NnB4OyBib3JkZXI6MXB4IHNvbGlkICMyMjI7IGJhY2tncm91bmQ6IzBiMGMwZDsgY29sb3I6I2VlZTsgZm9udC1zaXplOjE0cHg7IGJveC1zaXppbmc6Ym9yZGVyLWJveDsgfQogIGJ1dHRvbiB7IGJhY2tncm91bmQ6dmFyKC0tYWNjZW50KTsgY29sb3I6IzA0MjsgYm9yZGVyOm5vbmU7IHBhZGRpbmc6OHB4IDEycHg7IGJvcmRlci1yYWRpdXM6NnB4OyBjdXJzb3I6cG9pbnRlcjsgfQogIC5tdXRlZCB7IGNvbG9yOnZhcigtLW11dGVkKTsgZm9udC1zaXplOjEzcHg7IG1hcmdpbi10b3A6NnB4OyB9CiAgLmNvbnRyb2xzIHsgZGlzcGxheTpmbGV4OyBnYXA6OHB4OyBtYXJnaW4tdG9wOjEwcHg7IGZsZXgtd3JhcDp3cmFwOyB9CiAgLnN1bW1hcnkgeyBwYWRkaW5nOjEwcHg7IG1hcmdpbi10b3A6MTBweDsgYm9yZGVyLXJhZGl1czo2cHg7IGJhY2tncm91bmQ6IzBiMGMwZDsgYm9yZGVyOjFweCBzb2xpZCAjMjIyOyBkaXNwbGF5OmZsZXg7IGFsaWduLWl0ZW1zOmNlbnRlcjsganVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47IGdhcDo4cHg7IH0KICAucmVkIHsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCMzYjBiMGIyMiwgdHJhbnNwYXJlbnQpOyBib3JkZXI6MXB4IHNvbGlkICM1YzExMTE7IGNvbG9yOiNmZmIzYjM7IH0KICAueWVsbG93IHsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCMzYjMyMGIyMiwgdHJhbnNwYXJlbnQpOyBib3JkZXI6MXB4IHNvbGlkICM1YzQ4MTE7IGNvbG9yOiNmZmVhYTY7IH0KICAuZ3JlZW4geyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsIzBiM2IwYjIyLCB0cmFuc3BhcmVudCk7IGJvcmRlcjoxcHggc29saWQgIzExNWMxMTsgY29sb3I6I2JmZjBiZjsgfQogIC5pbnZhbGlkIHsgY29sb3I6I2ZmY2M2NjsgfQogIHRhYmxlIHsgd2lkdGg6MTAwJTsgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsgbWFyZ2luLXRvcDoxMHB4OyB9CiAgdGgsIHRkIHsgcGFkZGluZzo4cHg7IGJvcmRlci1ib3R0b206MXB4IHNvbGlkICMyMjI7IHRleHQtYWxpZ246bGVmdDsgZm9udC1zaXplOjEzcHg7IH0KICAud2lkZ2V0LWlmcmFtZSB7IHdpZHRoOjM1dnc7IGhlaWdodDoxMDB2aDsgYm9yZGVyOm5vbmU7IHBvc2l0aW9uOmZpeGVkOyB0b3A6MjBweDsgcmlnaHQ6MDsgei1pbmRleDo5OTk5OyB9CiAgLmhpZGRlbiB7IGRpc3BsYXk6bm9uZTsgfQogIC5pcC1jb250cm9scyB7IGRpc3BsYXk6ZmxleDsgZ2FwOjhweDsgbWFyZ2luLXRvcDoxMHB4OyBmbGV4LXdyYXA6d3JhcDsgfQogIC5zbWFsbCB7IGZvbnQtc2l6ZToxMnB4OyBjb2xvcjojMjY0ZDAwOyB9CiAgI2NvbG9yZWRSZXN1bHRzQ29udGFpbmVyIHsgbWFyZ2luLXRvcDoxMHB4OyBtYXgtaGVpZ2h0OjMyMHB4OyBvdmVyZmxvdzphdXRvOyBib3JkZXItcmFkaXVzOjZweDsgcGFkZGluZzo4cHg7IGJvcmRlcjoxcHggc29saWQgIzIyMjsgfQogIC5yZXN1bHQgeyBwYWRkaW5nOjhweDsgbWFyZ2luLWJvdHRvbTo2cHg7IGJvcmRlci1yYWRpdXM6NHB4OyBiYWNrZ3JvdW5kOiMwYjBjMGQ7IGJvcmRlcjoxcHggc29saWQgIzIyMjsgZGlzcGxheTpmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjsgZ2FwOjhweDsgYWxpZ24taXRlbXM6Y2VudGVyOyB9CiAgLmNzdi1idG4geyBiYWNrZ3JvdW5kOiM0Y2FmNTA7Y29sb3I6IzAyMjtwYWRkaW5nOjhweDtib3JkZXItcmFkaXVzOjZweDtib3JkZXI6bm9uZTtjdXJzb3I6cG9pbnRlcjsgfQogIC5yZXN1bHQubWFsaWNpb3VzIHsKICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCg5MGRlZywgcmdiYSgyNTUsNjgsNjgsMC4wNSksIHRyYW5zcGFyZW50KTsKICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LDY4LDY4LDAuMjUpOwogICAgY29sb3I6ICNmZmIzYjM7CiAgfQogIC5yZXN1bHQuaGlnaGx5LW1hbGljaW91cyB7CiAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsIHJnYmEoMjU1LDAsMCwwLjA4KSwgdHJhbnNwYXJlbnQpOwogICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMCwwLDAuNDUpOwogICAgY29sb3I6ICNmZmRlZGU7CiAgICBmb250LXdlaWdodDogNjAwOwogICAgYm94LXNoYWRvdzogMCA0cHggMTBweCByZ2JhKDI1NSwwLDAsMC4wNik7CiAgfQoKICAvKiBBZGRlZCBzdHlsZXMgdXNlZCBieSB0aGUgZW5oYW5jZWQgaGFzaCBVSSAqLwogIC5hcnJvdyB7IGN1cnNvcjpwb2ludGVyOyBmb250LXdlaWdodDo2MDA7IG1hcmdpbi1yaWdodDo2cHg7IGRpc3BsYXk6aW5saW5lLWJsb2NrOyB3aWR0aDoxOHB4OyB0ZXh0LWFsaWduOmNlbnRlcjsgfQogIC5kZXRhaWxzIHsgYmFja2dyb3VuZDojMGIwYzBkOyB9CiAgLmsgeyBkaXNwbGF5OmlubGluZS1ibG9jazsgd2lkdGg6MTYwcHg7IGNvbG9yOiM5YWQ7IH0KICAucmVkLXRleHQgeyBjb2xvcjojZmZiM2IzOyB9CiAgLmdyZWVuLXRleHQgeyBjb2xvcjojYmZmMGJmOyB9CgogIC8qIE5vbi1jb3B5YWJsZSBlbW9qaSB3cmFwcGVyICovCiAgLm5vbmNvcHkgeyB1c2VyLXNlbGVjdDogbm9uZTsgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsgLW1vei11c2VyLXNlbGVjdDogbm9uZTsgLW1zLXVzZXItc2VsZWN0OiBub25lOyBwb2ludGVyLWV2ZW50czogbm9uZTsgfQogIC8qIE1ha2UgdGhlIGJpZyBjb2xsYXBzZSBpY29uIG9idmlvdXMgKi8KICAjdG9nZ2xlSGFzaGVzQnRuIHsgZm9udC1zaXplOjIwcHg7IGxpbmUtaGVpZ2h0OjE7IHBhZGRpbmc6NnB4IDEwcHg7IGJhY2tncm91bmQ6dHJhbnNwYXJlbnQ7IGJvcmRlcjoxcHggc29saWQgIzIyMjsgY29sb3I6I2VlZTsgYm9yZGVyLXJhZGl1czo2cHg7IGN1cnNvcjpwb2ludGVyOyB9CiAgI3RvZ2dsZUhhc2hlc0J0bi5vcGVuIHsgdHJhbnNmb3JtOiByb3RhdGUoOTBkZWcpOyB9CiAgLyogZW5zdXJlIGFycm93L2Vtb2ppIGFyZSB2aXN1YWxseSBzZWxlY3RhYmxlIChjdXJzb3IpIGJ1dCBub3QgY29weWFibGUgKi8KICAuZW1vamkgeyBmb250LXdlaWdodDo3MDA7IGRpc3BsYXk6aW5saW5lLWJsb2NrOyBtYXJnaW4tcmlnaHQ6NnB4OyB9CiAgLyogaGlkZSBlbW9qaSBmcm9tIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMgaWYgZGVjb3JhdGl2ZSAqLwogIC5lbW9qaVthcmlhLWhpZGRlbj0idHJ1ZSJdIHsgcG9pbnRlci1ldmVudHM6IG5vbmU7IH0KPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KCjxkaXYgc3R5bGU9Im1heC13aWR0aDoxMjAwcHg7bWFyZ2luOjAgYXV0byAxOHB4OyI+CiAgPGgxPkJ1bGsgU2Nhbm5lciDigJQgRG9tYWlucywgSGFzaGVzICYgSVBzPC9oMT4KPC9kaXY+Cgo8ZGl2IGNsYXNzPSJ3cmFwIj4KICAKICA8ZGl2PgogICAgCiAgICA8ZGl2IGNsYXNzPSJjYXJkIj4KICAgICAgPGgyPkFidXNlSVBEQiDigJQgQnVsayBJUCBTY2FubmVyPC9oMj4KICAgICAgPHRleHRhcmVhIGlkPSJpcFRleHRBcmVhIiByb3dzPSI2IiBwbGFjZWhvbGRlcj0iRW50ZXIgSVBzLCBvbmUgcGVyIGxpbmUgKElQdjQpIj48L3RleHRhcmVhPgogICAgICA8ZGl2IGNsYXNzPSJtdXRlZCI+UHJpdmF0ZSBJUHMgd2lsbCBiZSBsaXN0ZWQgc2VwYXJhdGVseSBhbmQgbm90IHNjYW5uZWQuPC9kaXY+CgogICAgICA8ZGl2IGNsYXNzPSJpcC1jb250cm9scyI+CiAgICAgICAgPGJ1dHRvbiBpZD0ic2NhbklQc0J0biI+U2NhbiBJUHM8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGlkPSJjbGVhcklQc0J0biI+Q2xlYXIgUmVzdWx0czwvYnV0dG9uPgogICAgICAgIDxidXR0b24gaWQ9ImRvd25sb2FkQ1NWQnRuIiBjbGFzcz0iY3N2LWJ0biIgZGlzYWJsZWQ+RG93bmxvYWQgQ1NWPC9idXR0b24+CiAgICAgICAgPGRpdiBzdHlsZT0ibWFyZ2luLWxlZnQ6YXV0bzsgZGlzcGxheTpmbGV4OyBnYXA6NnB4OyI+CiAgICAgICAgICA8YnV0dG9uIGlkPSJmaWx0ZXJBbGxCdG4iIGNsYXNzPSJzbWFsbCI+QWxsPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGlkPSJmaWx0ZXJNYWxpY2lvdXNCdG4iIGNsYXNzPSJzbWFsbCI+TWFsaWNpb3VzPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGlkPSJmaWx0ZXJTYWZlQnRuIiBjbGFzcz0ic21hbGwiPlNhZmU8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGlkPSJwcml2YXRlRXJyb3JlZENvbnRhaW5lciIgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6OHB4O21hcmdpbi10b3A6MTBweDsiPgogICAgICAgIDx0ZXh0YXJlYSBpZD0icHJpdmF0ZUlQcyIgcm93cz0iMyIgcGxhY2Vob2xkZXI9IlByaXZhdGUgSVBzIChub3Qgc2Nhbm5lZCkiIHJlYWRvbmx5IHN0eWxlPSJ3aWR0aDo1MCUiPjwvdGV4dGFyZWE+CiAgICAgICAgPHRleHRhcmVhIGlkPSJlcnJvcmVkSVBzIiByb3dzPSIzIiBwbGFjZWhvbGRlcj0iRXJyb3JlZCBJUHMiIHJlYWRvbmx5IHN0eWxlPSJ3aWR0aDo1MCUiPjwvdGV4dGFyZWE+CiAgICAgIDwvZGl2PgoKICAgICAgPGRpdiBpZD0iY29sb3JlZFJlc3VsdHNDb250YWluZXIiIGFyaWEtbGl2ZT0icG9saXRlIj48L2Rpdj4KCiAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6MTBweDsiPgogICAgICAgIDx0ZXh0YXJlYSBpZD0ic2Nhbk91dHB1dCIgcm93cz0iMSIgc3R5bGU9IndpZHRoOjEwMCU7YmFja2dyb3VuZDojMGIwYzBkO2JvcmRlcjoxcHggc29saWQgIzIyMjtjb2xvcjojZWVlO3BhZGRpbmc6OHB4OyI+Q29weS0gU2NhbiByZXN1bHRzPC90ZXh0YXJlYT4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICAKICAgIDxkaXYgY2xhc3M9ImNhcmQiIHN0eWxlPSJtYXJnaW4tdG9wOjE0cHg7Ij4KICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4OyBhbGlnbi1pdGVtczpjZW50ZXI7IGp1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOyI+CiAgICAgICAgPGgyIHN0eWxlPSJtYXJnaW46MDsiPlZpcnVzVG90YWwrTWFsd2FyZUJhemFhcitBbGllblZhdWx0IE9UWCDigJQgQnVsayBIYXNoIFNjYW5uZXI8L2gyPgogICAgICA8L2Rpdj4KCiAgICAgIDx0ZXh0YXJlYSBpZD0iaGFzaElucHV0IiByb3dzPSI0IiBwbGFjZWhvbGRlcj0iUGFzdGUgdGV4dCBjb250YWluaW5nIE1ENS9TSEExL1NIQTI1NiBoYXNoZXMiPjwvdGV4dGFyZWE+CiAgICAgIDxkaXYgY2xhc3M9Im11dGVkIj5QYXN0ZSBhbnkgdGV4dCB3aXRoIGhhc2hlczsgTUQ1KDMyKSwgU0hBMSg0MCksIFNIQTI1Nig2NCkgd2lsbCBiZSBleHRyYWN0ZWQgYW5kIGRlZHVwbGljYXRlZC48L2Rpdj4KICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo4cHg7bWFyZ2luLXRvcDoxMHB4O2FsaWduLWl0ZW1zOmNlbnRlcjsiPgogICAgICAgIDxidXR0b24gaWQ9InNjYW5IYXNoZXNCdG4iPlNjYW4gSGFzaGVzPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0iY2xlYXJIYXNoZXNCdG4iPkNsZWFyIFJlc3VsdHM8L2J1dHRvbj4KICAgICAgICA8bGFiZWwgY2xhc3M9InNtYWxsIj5EZWxheSAobXMpOgogICAgICAgICAgPGlucHV0IGlkPSJkZWxheU1zIiB0eXBlPSJudW1iZXIiIHZhbHVlPSIxMDAwIiBzdHlsZT0id2lkdGg6OTBweDttYXJnaW4tbGVmdDo2cHgiLz4KICAgICAgICA8L2xhYmVsPgogICAgICA8L2Rpdj48YnI+CiAgICAgIAogICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDsgZ2FwOjhweDsgYWxpZ24taXRlbXM6Y2VudGVyOyI+CiAgICAgICAgICA8YnV0dG9uIGlkPSJ0b2dnbGVIYXNoZXNCdG4iIHRpdGxlPSJDb2xsYXBzZSAvIEV4cGFuZCBhbGwgaGFzaCBkZXRhaWxzIiBhcmlhLXByZXNzZWQ9ImZhbHNlIj48c3BhbiBjbGFzcz0iZW1vamkgbm9uY29weSIgYXJpYS1oaWRkZW49InRydWUiPuKWtjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgICAgPHRhYmxlIGlkPSJoYXNoUmVzdWx0c1RhYmxlIj4KICAgICAgICA8dGhlYWQ+PHRyPjx0aD5IYXNoPC90aD48dGg+VmVyZGljdDwvdGg+PC90cj48L3RoZWFkPgogICAgICAgIDx0Ym9keSBpZD0iaGFzaFJlc3VsdHNCb2R5Ij48L3Rib2R5PgogICAgICA8L3RhYmxlPgogICAgPC9kaXY+CgogICAgCiAgICA8ZGl2IGNsYXNzPSJjYXJkIiBzdHlsZT0ibWFyZ2luLXRvcDoxNHB4OyI+CiAgICAgIDxoMj5WaXJ1c1RvdGFsIOKAlCBEb21haW4gJiBVUkwgU2Nhbm5lcjwvaDI+CiAgICAgIDx0ZXh0YXJlYSBpZD0iZG9tYWluSW5wdXQiIHJvd3M9IjMiIHBsYWNlaG9sZGVyPSJFbnRlciBkb21haW5zIG9yIFVSTHMsIG9uZSBwZXIgbGluZSAoZXhhbXBsZS5jb20gb3IgaHR0cHM6Ly9leGFtcGxlLmNvbS9wYXRoKSI+PC90ZXh0YXJlYT4KICAgICAgPGRpdiBjbGFzcz0ibXV0ZWQiPkVudGVyIGRvbWFpbnMgKGV4YW1wbGUuY29tKSBvciBmdWxsIFVSTHMgKENoZWNrcyBvbmx5IGV4aXN0aW5nIFVSTFMgaW4gVlQgZGF0YWJhc2UpCiAgICAgIDxicj5SZW1lbWJlciB0byBIaWRlIFdpZGdldCBhZnRlciBjbGlja2luZyBTaG93IFdpZGdldDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJjb250cm9scyI+CiAgICAgICAgPGJ1dHRvbiBpZD0ic2NhbkRvbWFpbnNCdG4iPlNjYW4gRG9tYWlucy9VUkxzPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0iY2xlYXJEb21haW5CdG4iPkNsZWFyIFJlc3VsdHM8L2J1dHRvbj4KICAgICAgPC9kaXY+CgogICAgICAKICAgICAgPGRpdiBpZD0iZG9tYWluT3V0cHV0Ij48L2Rpdj4KCiAgICAgIAogICAgICA8ZGl2IGlkPSJ1cmxPdXRwdXQiIHN0eWxlPSJtYXJnaW4tdG9wOjEycHg7Ij48L2Rpdj4KICAgIDwvZGl2PgoKICA8L2Rpdj4KCiAgCiAgPGRpdj4KICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICA8aDM+U2V0dGluZ3MgJiBXb3JrZXI8L2gzPgogICAgICA8ZGl2IGNsYXNzPSJtdXRlZCI+U2V0IHlvdXIgV29ya2VyIFVSTCAobXVzdCBlbmQgd2l0aCAnLycpLiBUaGUgV29ya2VyIHNob3VsZCBpbmplY3QgPGNvZGU+eC1hcGlrZXk8L2NvZGU+IGZvciBWaXJ1c1RvdGFsIGFuZCA8Y29kZT5LZXk8L2NvZGU+IGZvciBBYnVzZUlQREIuPC9kaXY+CiAgICAgIDxpbnB1dCBpZD0icHJveHlCYXNlIiB2YWx1ZT0iaHR0cHM6Ly9vZGQtZGlzay1mNWRhLjRyMG00MS1zb2Mud29ya2Vycy5kZXYvIiAvPgogICAgICA8aHIgc3R5bGU9ImJvcmRlci1jb2xvcjojMjIyO21hcmdpbjoxMnB4IDA7Ii8+CiAgICAgIDxoMz5RdWljayBzdGF0dXM8L2gzPgogICAgICA8ZGl2IGlkPSJzdGF0dXNCb3giIGNsYXNzPSJzbWFsbCI+UmVhZHkuPC9kaXY+CiAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6MTBweDsiPgogICAgICAgIDxidXR0b24gaWQ9InRlc3RXb3JrZXJCdG4iPlRlc3QgV29ya2VyIChWVCBkb21haW4gZXhhbXBsZSk8L2J1dHRvbj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJjYXJkIiBzdHlsZT0ibWFyZ2luLXRvcDoxNHB4OyI+CiAgICAgIDxoMz5Ob3RlczwvaDM+CiAgICAgIDxkaXYgY2xhc3M9InNtYWxsIj4KICAgICAgICDigKIgQWRkIHNlY3JldHMgdG8gV29ya2VyOiA8Y29kZT5WVF9BUElfS0VZPC9jb2RlPiBhbmQgPGNvZGU+QUJVU0VJUERCX0tFWTwvY29kZT4uPGJyLz4KICAgICAgICDigKIgV29ya2VyIG11c3Qgc3RyaXAgY2xpZW50LXN1cHBsaWVkIGF1dGggaGVhZGVycyBhbmQgc2V0IHRoZSBhcHByb3ByaWF0ZSBzZWNyZXQgaGVhZGVyIGZvciBlYWNoIEFQSS4gPGJyLz4KICAgICAgICDigKIgUmF0ZSBsaW1pdHMgYXBwbHkg4oCUIHVzZSBkZWxheS9iYXRjaGluZyBmb3IgbGFyZ2Ugc2NhbnMuCiAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgPC9kaXY+CjwvZGl2PgoKPHNjcmlwdD4Kd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciBfMHgxID0gd2luZG93LmRvY3VtZW50OwogICAgdmFyIF8weDIgPSB3aW5kb3cubG9jYWxTdG9yYWdlOwogICAgXzB4MS5jb29raWUgPSAiUVhWMGFHOXk9U25sdmRHaHBJRkpoYWlCVyI7CiAgICBfMHgyLnNldEl0ZW0oIlFYVjBhRzl5IiwgIlNubHZkR2hwSUZKaGFpQlciKTsKfTsKLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0gU2hhcmVkIGNvbmZpZyAtLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwpsZXQgUFJPWFlfQkFTRSA9ICcnOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJveHlCYXNlJykuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBlID0+IFBST1hZX0JBU0UgPSBlLnRhcmdldC52YWx1ZS50cmltKCkpOwoKZnVuY3Rpb24gc2V0U3RhdHVzKG1zZywgZXJyPWZhbHNlKXsKICBjb25zdCBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXR1c0JveCcpOwogIHMudGV4dENvbnRlbnQgPSBtc2c7CiAgcy5zdHlsZS5jb2xvciA9IGVyciA/ICcjZmZiM2IzJyA6ICcjYmZlZmZmJzsKfQoKZnVuY3Rpb24gYnVpbGRQcm94aWVkVXJsKHRhcmdldFVybCl7CiAgaWYoIVBST1hZX0JBU0UpIHRocm93IG5ldyBFcnJvcignUFJPWFlfQkFTRSBub3Qgc2V0LiBQbGVhc2Ugc2V0IHlvdXIgV29ya2VyIFVSTCBpbiB0aGUgcmlnaHQgcGFuZWwuJyk7CiAgbGV0IGJhc2UgPSBQUk9YWV9CQVNFOwogIGlmKCFiYXNlLmVuZHNXaXRoKCcvJykpIGJhc2UgKz0gJy8nOwogIHJldHVybiBiYXNlICsgZW5jb2RlVVJJQ29tcG9uZW50KHRhcmdldFVybCk7Cn0KZnVuY3Rpb24gZXNjYXBlSHRtbChzKXsgaWYgKHM9PT1udWxsfHxzPT09dW5kZWZpbmVkKSByZXR1cm4gJyc7IHJldHVybiBTdHJpbmcocykucmVwbGFjZSgvWyY8PiJdL2csIGNoPT4oeycmJzonJmFtcDsnLCc8JzonJmx0OycsJz4nOicmZ3Q7JywnIic6JyZxdW90Oyd9W2NoXSkpOyB9CmZ1bmN0aW9uIHNsZWVwKG1zKXsgcmV0dXJuIG5ldyBQcm9taXNlKHI9PnNldFRpbWVvdXQociwgbXMpKTsgfQoKLyogLS0tLS0tLS0tLS0tLS0tLS0tIENvcHkgc2FuaXRpc2VyOiByZW1vdmUgdGhlIHNwZWNpYWwgZW1vamlzIGZyb20gY29waWVkIHRleHQgLS0tLS0tLS0tLS0tLS0tLS0tICovCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NvcHknLCAoZXYpID0+IHsKICB0cnkgewogICAgY29uc3Qgc2VsID0gd2luZG93LmdldFNlbGVjdGlvbigpOwogICAgaWYoIXNlbCkgcmV0dXJuOwogICAgY29uc3QgdGV4dCA9IHNlbC50b1N0cmluZygpOwogICAgLy8gcmVtb3ZlIHRoZSBlbW9qaXMgd2UgbWFkZSBub24tY29weWFibGUKICAgIGNvbnN0IGNsZWFuZWQgPSB0ZXh0LnJlcGxhY2UoL1tcdXsxRjUzOX1cdXsyNzA1fVx1ezFGNTM0fVx1ezI1QjZ9XHV7MjVCQX1cdXsyNUI4fVx1ezI1Qjd9XS9ndSwgJycpOyAvLyBjb3ZlcnMg8J+UmCDinIUg8J+UtCDilrYgYW5kIHZhcmlhbnRzCiAgICAvLyB3cml0ZSBjbGVhbmVkIHN0cmluZyB0byBjbGlwYm9hcmQKICAgIGV2LmNsaXBib2FyZERhdGEuc2V0RGF0YSgndGV4dC9wbGFpbicsIGNsZWFuZWQpOwogICAgZXYucHJldmVudERlZmF1bHQoKTsKICB9IGNhdGNoKGUpewogICAgLy8gaWdub3JlLCBkZWZhdWx0IGNvcHkgd2lsbCBoYXBwZW4KICB9Cn0pOwoKLyogLS0tLS0tLS0tLS0tLS0tLS0tIEhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tICovCmZ1bmN0aW9uIHRvRmxhZ0Vtb2ppKGNvdW50cnlDb2RlKXsKICBpZighY291bnRyeUNvZGUgfHwgdHlwZW9mIGNvdW50cnlDb2RlICE9PSAnc3RyaW5nJykgcmV0dXJuICcnOwogIGNvbnN0IGNjID0gY291bnRyeUNvZGUudG9VcHBlckNhc2UoKTsKICBpZihjYy5sZW5ndGggIT09IDIpIHJldHVybiBjYzsKICBjb25zdCBiYXNlID0gMHgxRjFFNjsgLy8gcmVnaW9uYWwgaW5kaWNhdG9yIHN5bWJvbCBsZXR0ZXIgQQogIGNvbnN0IGZpcnN0ID0gY2MuY2hhckNvZGVBdCgwKSAtIDY1OwogIGNvbnN0IHNlY29uZCA9IGNjLmNoYXJDb2RlQXQoMSkgLSA2NTsKICBpZihmaXJzdCA8IDAgfHwgc2Vjb25kIDwgMCB8fCBmaXJzdCA+IDI1IHx8IHNlY29uZCA+IDI1KSByZXR1cm4gY2M7CiAgcmV0dXJuIFN0cmluZy5mcm9tQ29kZVBvaW50KGJhc2UgKyBmaXJzdCwgYmFzZSArIHNlY29uZCk7Cn0KCi8qIC0tLS0tLS0tLS0tLS0tLS0tLSBUcmFjayBzY2FubmVkIGRvbWFpbnMgdG8gYXZvaWQgZHVwbGljYXRlcyAtLS0tLS0tLS0tLS0tLS0tLS0gKi8KY29uc3Qgc2Nhbm5lZERvbWFpbnMgPSBuZXcgU2V0KCk7CgovKiAtLS0tLS0tLS0tLS0tLS0tLS0gRG9tYWluK1VSTCBzY2FubmVyIChzaW5nbGUgaW5wdXQpIC0tLS0tLS0tLS0tLS0tLS0tLSAqLwpjb25zdCBkb21haW5JbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkb21haW5JbnB1dCcpOwpjb25zdCBkb21haW5PdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG9tYWluT3V0cHV0Jyk7CmNvbnN0IHVybE91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cmxPdXRwdXQnKTsKCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FuRG9tYWluc0J0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7CiAgY29uc3QgdHh0ID0gZG9tYWluSW5wdXQudmFsdWUudHJpbSgpOyBpZighdHh0KXsgc2V0U3RhdHVzKCdFbnRlciBhdCBsZWFzdCBvbmUgZG9tYWluIG9yIFVSTCcsIHRydWUpOyByZXR1cm47IH0KICBjb25zdCBsaW5lcyA9IHR4dC5zcGxpdCgvXHI/XG4vKS5tYXAoZD0+ZC50cmltKCkpLmZpbHRlcihCb29sZWFuKTsKICBkb21haW5PdXRwdXQuaW5uZXJIVE1MPScnOyB1cmxPdXRwdXQuaW5uZXJIVE1MPScnOyBQUk9YWV9CQVNFID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb3h5QmFzZScpLnZhbHVlLnRyaW0oKTsKICBzZXRTdGF0dXMoJ1NjYW5uaW5nIGRvbWFpbnMvVVJMcy4uLicpOwogIChhc3luYyAoKT0+ewogICAgZm9yKGNvbnN0IGxuIG9mIEFycmF5LmZyb20obmV3IFNldChsaW5lcykpKXsKICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZUlucHV0KGxuKTsKICAgICAgLy8gZGVjaWRlIHdoZXRoZXIgVVJMIG9yIGRvbWFpbjoKICAgICAgaWYoaXNMaWtlbHlVcmwobm9ybWFsaXplZCkpIHsKICAgICAgICAvLyBydW4gVVJMIGZsb3cKICAgICAgICBhd2FpdCBzY2FuVVJMKG5vcm1hbGl6ZWQpLmNhdGNoKCgpPT57IC8qIGVycm9ycyBoYW5kbGVkIGluIHNjYW5VUkwgKi8gfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gcnVuIGRvbWFpbiBmbG93CiAgICAgICAgYXdhaXQgc2NhbkRvbWFpbihub3JtYWxpemVkKS5jYXRjaCgoKT0+eyAvKiBlcnJvcnMgaGFuZGxlZCBpbiBzY2FuRG9tYWluICovIH0pOwogICAgICB9CiAgICAgIC8vIHNtYWxsIHRocm90dGxlCiAgICAgIGF3YWl0IHNsZWVwKDMwMCk7CiAgICB9CiAgICBzZXRTdGF0dXMoJ0RvbWFpbi9VUkwgc2Nhbm5pbmcgZmluaXNoZWQuJyk7CiAgfSkoKTsKfSk7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhckRvbWFpbkJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7IGRvbWFpbk91dHB1dC5pbm5lckhUTUw9Jyc7IHVybE91dHB1dC5pbm5lckhUTUw9Jyc7IHNjYW5uZWREb21haW5zLmNsZWFyKCk7IH0pOwoKLyogTm9ybWFsaXphdGlvbiBydWxlcyAodW5jaGFuZ2VkKSAqLwpmdW5jdGlvbiBub3JtYWxpemVJbnB1dChzKXsKICBpZighcykgcmV0dXJuIHM7CiAgbGV0IHQgPSBTdHJpbmcocykudHJpbSgpOwogIGlmKHQuc3RhcnRzV2l0aCgnPCcpICYmIHQuZW5kc1dpdGgoJz4nKSkgdCA9IHQuc2xpY2UoMSwtMSkudHJpbSgpOwogIGlmKC9eW2EtekEtWl1bYS16QS1aMC05K1wtLl0qOlwvXC8vLnRlc3QodCkpIHsKICAgIHJldHVybiB0LnJlcGxhY2UoL15bXHMiJzxdK3xbXHMiJz5dKyQvZywnJyk7CiAgfQogIGlmKHQuaW5kZXhPZignLycpICE9PSAtMSl7CiAgICBjb25zdCBwYXJ0cyA9IHQuc3BsaXQoJy8nKTsKICAgIGNvbnN0IGhvc3QgPSBwYXJ0c1swXTsKICAgIGNvbnN0IHJlc3QgPSBwYXJ0cy5zbGljZSgxKS5qb2luKCcvJyk7CiAgICBjb25zdCBjbGVhbmVkSG9zdCA9IGNsZWFuSG9zdChob3N0KTsKICAgIGlmKHJlc3QgPT09ICcnKSB7CiAgICAgIHJldHVybiBjbGVhbmVkSG9zdDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBjbGVhbmVkSG9zdCArICcvJyArIHJlc3Q7CiAgICB9CiAgfQogIHJldHVybiBjbGVhbkhvc3QodCk7Cn0KCmZ1bmN0aW9uIGNsZWFuSG9zdChoKXsKICBpZighaCkgcmV0dXJuIGg7CiAgbGV0IGMgPSBTdHJpbmcoaCkudHJpbSgpOwogIGMgPSBjLnJlcGxhY2UoL15bXC5cLVxfXSsvLCAnJyk7CiAgYyA9IGMucmVwbGFjZSgvW1wuXC1cX10rJC8sJycpOwogIGMgPSBjLnJlcGxhY2UoL15bXC5cLVxfXSsvLCAnJyk7CiAgcmV0dXJuIGM7Cn0KCmZ1bmN0aW9uIGlzTGlrZWx5VXJsKHMpewogIGlmKCFzKSByZXR1cm4gZmFsc2U7CiAgaWYoL15bYS16QS1aXVthLXpBLVowLTkrXC0uXSo6XC9cLy8udGVzdChzKSkgcmV0dXJuIHRydWU7CiAgaWYoL1wvLisvLnRlc3QocykpIHJldHVybiB0cnVlOwogIGlmKC9cPy4rPS8udGVzdChzKSkgcmV0dXJuIHRydWU7CiAgcmV0dXJuIGZhbHNlOwp9CgovKiAtLS0tLS0tLS0tLS0tLS0tLS0gRG9tYWluIHNjYW5uZXIgLS0tLS0tLS0tLS0tLS0tLS0tICovCmFzeW5jIGZ1bmN0aW9uIHNjYW5Eb21haW4oZG9tYWluKXsKICAvLyBkZWR1cGUKICBpZihzY2FubmVkRG9tYWlucy5oYXMoZG9tYWluKSkgcmV0dXJuOwogIHNjYW5uZWREb21haW5zLmFkZChkb21haW4pOwoKICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgY29udGFpbmVyLmNsYXNzTmFtZT0nc3VtbWFyeSc7IGNvbnRhaW5lci5pbm5lckhUTUw9YDxzdHJvbmc+JHtlc2NhcGVIdG1sKGRvbWFpbil9PC9zdHJvbmc+IOKAlCBjaGVja2luZy4uLmA7CiAgZG9tYWluT3V0cHV0LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7CiAgdHJ5IHsKICAgIGNvbnN0IHZ0VXJsID0gYGh0dHBzOi8vd3d3LnZpcnVzdG90YWwuY29tL2FwaS92My9kb21haW5zLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGRvbWFpbil9YDsKICAgIGNvbnN0IHByb3hpZWQgPSBidWlsZFByb3hpZWRVcmwodnRVcmwpOwogICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2gocHJveGllZCx7bWV0aG9kOidHRVQnLCBoZWFkZXJzOnsnQWNjZXB0JzonYXBwbGljYXRpb24vanNvbid9fSk7CiAgICBpZighcmVzLm9rKXsKICAgICAgY29uc3QgdCA9IGF3YWl0IHJlcy50ZXh0KCkuY2F0Y2goKCk9PnJlcy5zdGF0dXNUZXh0KTsKICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0VlRFcnJvcihyZXMuc3RhdHVzLCB0KTsKICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3JlZCcpOwogICAgICBjb250YWluZXIuaW5uZXJIVE1MPWA8c3Ryb25nPiR7ZXNjYXBlSHRtbChkb21haW4pfTwvc3Ryb25nPiDigJQgJHtlc2NhcGVIdG1sKGZvcm1hdHRlZCl9YDsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlcy5qc29uKCk7CiAgICBjb25zdCBhdHRycyA9IGRhdGEuZGF0YSAmJiBkYXRhLmRhdGEuYXR0cmlidXRlcyA/IGRhdGEuZGF0YS5hdHRyaWJ1dGVzIDogbnVsbDsKICAgIGlmKCFhdHRycyl7IGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdyZWQnKTsgY29udGFpbmVyLmlubmVySFRNTD1gPHN0cm9uZz4ke2VzY2FwZUh0bWwoZG9tYWluKX08L3N0cm9uZz4g4oCUIEludmFsaWQgVlQgcmVzcG9uc2VgOyByZXR1cm47IH0KICAgIGNvbnN0IHN0YXRzID0gYXR0cnMubGFzdF9hbmFseXNpc19zdGF0cyB8fCB7fTsgY29uc3QgbSA9IHN0YXRzLm1hbGljaW91c3x8MCwgcyA9IHN0YXRzLnN1c3BpY2lvdXN8fDAsIGggPSBzdGF0cy5oYXJtbGVzc3x8MCwgdG90YWwgPSBtK3MraHx8MDsKICAgIGNvbnN0IGRlZiA9IGRvbWFpbi5yZXBsYWNlKC9cLi9nLCdbLl0nKTsKICAgIGlmKG0+MCl7IGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdyZWQnKTsgY29udGFpbmVyLmlubmVySFRNTD1gPHN0cm9uZz4ke2VzY2FwZUh0bWwoZGVmKX08L3N0cm9uZz4g4oCUICR7bX0vJHt0b3RhbH0gdmVuZG9ycyBmbGFnZ2VkIGFzIG1hbGljaW91cy5gOyB9CiAgICBlbHNlIGlmKHM+MCl7IGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCd5ZWxsb3cnKTsgY29udGFpbmVyLmlubmVySFRNTD1gPHN0cm9uZz4ke2VzY2FwZUh0bWwoZGVmKX08L3N0cm9uZz4g4oCUICR7c30vJHt0b3RhbH0gdmVuZG9ycyBmbGFnZ2VkIGFzIHN1c3BpY2lvdXMuYDsgfQogICAgZWxzZSB7IGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdncmVlbicpOyBjb250YWluZXIuaW5uZXJIVE1MPWA8c3Ryb25nPiR7ZXNjYXBlSHRtbChkZWYpfTwvc3Ryb25nPiDigJQgTm90IGZsYWdnZWQgLyBTYWZlLmA7IH0KICAgIGNvbnN0IHdpZGdldEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOyB3aWRnZXRCdG4udGV4dENvbnRlbnQ9J1Nob3cgV2lkZ2V0Jzsgd2lkZ2V0QnRuLnN0eWxlLm1hcmdpbkxlZnQ9JzhweCc7CiAgICB3aWRnZXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHRvZ2dsZVdpZGdldChkb21haW4sIHdpZGdldEJ0bikpOwogICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHdpZGdldEJ0bik7CiAgfSBjYXRjaChlcnIpeyBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgncmVkJyk7IGNvbnRhaW5lci5pbm5lckhUTUw9YDxzdHJvbmc+JHtlc2NhcGVIdG1sKGRvbWFpbil9PC9zdHJvbmc+IOKAlCAke2VzY2FwZUh0bWwoZXJyLm1lc3NhZ2UpfWA7IH0KfQoKLyogLS0tLS0tLS0tLS0tLS0tLS0tIEhhc2ggc2Nhbm5lciAoRU5IQU5DRUQpIC0tLS0tLS0tLS0tLS0tLS0tLSAqLwpjb25zdCBoYXNoSW5wdXRFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoYXNoSW5wdXQnKTsKY29uc3QgaGFzaFJlc3VsdHNCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hhc2hSZXN1bHRzQm9keScpOwoKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NsZWFySGFzaGVzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IGhhc2hSZXN1bHRzQm9keS5pbm5lckhUTUw9JycpOwoKY29uc3QgaGFzaENhcHR1cmVSZWdleCA9IC9cYihbQS1GYS1mMC05XXszMn18W0EtRmEtZjAtOV17NDB9fFtBLUZhLWYwLTldezY0fSlcYi9nOwoKLyogcGFzdGUgY29udmVuaWVuY2UgKi8KaGFzaElucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcigncGFzdGUnLCAoZSk9PnsKICB0cnkgewogICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgY29uc3QgdGV4dCA9IChlLmNsaXBib2FyZERhdGF8fHdpbmRvdy5jbGlwYm9hcmREYXRhKS5nZXREYXRhKCd0ZXh0Jyl8fCcnOwogICAgY29uc3QgbWF0Y2hlcyA9IHRleHQubWF0Y2goaGFzaENhcHR1cmVSZWdleCk7CiAgICBoYXNoSW5wdXRFbC52YWx1ZSA9IG1hdGNoZXMgPyBBcnJheS5mcm9tKG5ldyBTZXQobWF0Y2hlcy5tYXAobT0+bS50b0xvd2VyQ2FzZSgpKSkpLmpvaW4oJ1xuJykgOiAnJzsKICB9IGNhdGNoKGVycil7fQp9KTsKCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FuSGFzaGVzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKT0+ewogIFBST1hZX0JBU0UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJveHlCYXNlJykudmFsdWUudHJpbSgpOwogIGNvbnN0IGRlbGF5ID0gTWF0aC5tYXgoMCwgcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlbGF5TXMnKS52YWx1ZXx8JzEwMDAnLDEwKSk7CgogIGNvbnN0IHJhdyA9IGhhc2hJbnB1dEVsLnZhbHVlIHx8ICcnOwogIGNvbnN0IGZvdW5kID0gcmF3Lm1hdGNoKGhhc2hDYXB0dXJlUmVnZXgpIHx8IFtdOwogIGNvbnN0IGhhc2hlcyA9IEFycmF5LmZyb20obmV3IFNldChmb3VuZC5tYXAoaD0+aC50b0xvd2VyQ2FzZSgpKSkpOwoKICBpZihoYXNoZXMubGVuZ3RoID09PSAwKXsKICAgIHNldFN0YXR1cygnTm8gaGFzaGVzIGRldGVjdGVkIHRvIHNjYW4uJywgdHJ1ZSk7CiAgICByZXR1cm47CiAgfQoKICBoYXNoUmVzdWx0c0JvZHkuaW5uZXJIVE1MID0gJyc7CiAgc2V0U3RhdHVzKGBTY2FubmluZyAke2hhc2hlcy5sZW5ndGh9IGhhc2hlcy4uLmApOwoKICBmb3IoY29uc3QgaCBvZiBoYXNoZXMpewoKICAgIGNvbnN0IHJvdyA9IGhhc2hSZXN1bHRzQm9keS5pbnNlcnRSb3coKTsKICAgIGNvbnN0IGMxID0gcm93Lmluc2VydENlbGwoKTsKICAgIGNvbnN0IGMyID0gcm93Lmluc2VydENlbGwoKTsKCiAgICAvLyBhcnJvdyBpcyBub24tY29weWFibGUgZW1vamkKICAgIGMxLmlubmVySFRNTCA9IGA8c3BhbiBjbGFzcz0iYXJyb3ciPjxzcGFuIGNsYXNzPSJlbW9qaSBub25jb3B5IiBhcmlhLWhpZGRlbj0idHJ1ZSI+4pa2PC9zcGFuPjwvc3Bhbj4ke2VzY2FwZUh0bWwoaCl9YDsKICAgIGMyLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPSJzdGF0dXMiPjxzcGFuIGNsYXNzPSJlbW9qaSBub25jb3B5IiBhcmlhLWhpZGRlbj0idHJ1ZSI+8J+UmDwvc3Bhbj4gPHNwYW4gY2xhc3M9InN0YXR1cy10ZXh0Ij5DaGVja2luZ+KApjwvc3Bhbj48L2Rpdj5gOwoKICAgIGNvbnN0IGRyb3cgPSBoYXNoUmVzdWx0c0JvZHkuaW5zZXJ0Um93KCk7CiAgICBkcm93LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICBkcm93LmNsYXNzTmFtZSA9ICdkZXRhaWxzJzsKICAgIGNvbnN0IGRjID0gZHJvdy5pbnNlcnRDZWxsKCk7CiAgICBkYy5jb2xTcGFuID0gMjsKCiAgICBsZXQgdnRGb3VuZCA9IGZhbHNlLCBtYkZvdW5kID0gZmFsc2UsIGF2Rm91bmQgPSBmYWxzZTsKCiAgICBsZXQgdnQgPSB7IG5hbWU6J+KAlCcsIGxhYmVsOifigJQnLCBzY29yZTon4oCUJywgYmFkOmZhbHNlIH07CiAgICBsZXQgbWIgPSB7IGZpbGU6J+KAlCcsIHRhZ3M6JycgfTsKICAgIGxldCBhdiA9IHsgcHVsc2VDb3VudDowLCB2ZXJkaWN0OifigJQnIH07CgogICAgLyogLS0tLS0tLS0tLS0tLS0tLSBWaXJ1c1RvdGFsIC0tLS0tLS0tLS0tLS0tLS0gKi8KICAgIHRyeSB7CiAgICAgIGNvbnN0IHZ0VXJsID0gYnVpbGRQcm94aWVkVXJsKGBodHRwczovL3d3dy52aXJ1c3RvdGFsLmNvbS9hcGkvdjMvZmlsZXMvJHtlbmNvZGVVUklDb21wb25lbnQoaCl9YCk7CiAgICAgIGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh2dFVybCwgeyBtZXRob2Q6J0dFVCcsIGhlYWRlcnM6eyAnQWNjZXB0JzonYXBwbGljYXRpb24vanNvbicgfX0pOwogICAgICBpZihyLm9rKXsKICAgICAgICBjb25zdCBqID0gYXdhaXQgci5qc29uKCkuY2F0Y2goKCk9Pm51bGwpOwogICAgICAgIGNvbnN0IGEgPSBqPy5kYXRhPy5hdHRyaWJ1dGVzOwogICAgICAgIGlmKGEpewogICAgICAgICAgdnRGb3VuZCA9IHRydWU7CiAgICAgICAgICBjb25zdCBzID0gYS5sYXN0X2FuYWx5c2lzX3N0YXRzIHx8IHt9OwogICAgICAgICAgY29uc3QgdG90YWwgPSBPYmplY3QudmFsdWVzKHMpLnJlZHVjZSgoYSxiKT0+YSsoYnx8MCksMCk7CiAgICAgICAgICB2dCA9IHsKICAgICAgICAgICAgc2NvcmU6IGAke3MubWFsaWNpb3VzfHwwfS8ke3RvdGFsfHwwfWAsCiAgICAgICAgICAgIGxhYmVsOiBhLnN1Z2dlc3RlZF90aHJlYXRfbGFiZWwgfHwgJ+KAlCcsCiAgICAgICAgICAgIG5hbWU6IGEubWVhbmluZ2Z1bF9uYW1lIHx8IGEubmFtZXM/LlswXSB8fCAn4oCUJywKICAgICAgICAgICAgYmFkOiAocy5tYWxpY2lvdXN8fDApID4gMAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2goZSl7fQoKICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0gTWFsd2FyZUJhemFhciAtLS0tLS0tLS0tLS0tLS0tICovCiAgICB0cnkgewogICAgICBjb25zdCBtYlVybCA9IGJ1aWxkUHJveGllZFVybCgnaHR0cHM6Ly9tYi1hcGkuYWJ1c2UuY2gvYXBpL3YxLycpOwogICAgICBjb25zdCByID0gYXdhaXQgZmV0Y2gobWJVcmwsIHsKICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsCiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgfSwKICAgICAgICBib2R5OiBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgcXVlcnk6J2dldF9pbmZvJywgaGFzaDogaCB9KQogICAgICB9KTsKCiAgICAgIGlmKHIub2spewogICAgICAgIGNvbnN0IGogPSBhd2FpdCByLmpzb24oKS5jYXRjaCgoKT0+bnVsbCk7CiAgICAgICAgaWYoaiAmJiBqLnF1ZXJ5X3N0YXR1cyA9PT0gJ29rJyAmJiBBcnJheS5pc0FycmF5KGouZGF0YSkgJiYgai5kYXRhLmxlbmd0aCl7CiAgICAgICAgICBtYkZvdW5kID0gdHJ1ZTsKICAgICAgICAgIG1iID0gewogICAgICAgICAgICBmaWxlOiBqLmRhdGFbMF0uZmlsZV9uYW1lIHx8ICfigJQnLAogICAgICAgICAgICB0YWdzOiAoai5kYXRhWzBdLnRhZ3MgfHwgW10pLmpvaW4oJywgJykKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoKGUpe30KCiAgICAvKiAtLS0tLS0tLS0tLS0tLS0tIEFsaWVuVmF1bHQgT1RYIC0tLS0tLS0tLS0tLS0tLS0gKi8KICAgIHRyeSB7CiAgICAgIGNvbnN0IGF2VXJsID0gYnVpbGRQcm94aWVkVXJsKGBodHRwczovL290eC5hbGllbnZhdWx0LmNvbS9hcGkvdjEvaW5kaWNhdG9ycy9maWxlLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGgpfWApOwogICAgICBjb25zdCByID0gYXdhaXQgZmV0Y2goYXZVcmwsIHsgbWV0aG9kOidHRVQnLCBoZWFkZXJzOnsgJ0FjY2VwdCc6J2FwcGxpY2F0aW9uL2pzb24nIH19KTsKICAgICAgaWYoci5vayl7CiAgICAgICAgY29uc3QgaiA9IGF3YWl0IHIuanNvbigpLmNhdGNoKCgpPT5udWxsKTsKICAgICAgICBjb25zdCBwdWxzZXMgPSBqPy5wdWxzZV9pbmZvPy5wdWxzZXMgfHwgW107CiAgICAgICAgYXYucHVsc2VDb3VudCA9IHB1bHNlcy5sZW5ndGg7CiAgICAgICAgaWYocHVsc2VzLmxlbmd0aCA+IDApIGF2Rm91bmQgPSB0cnVlOwogICAgICAgIGlmKHB1bHNlcy5sZW5ndGggPj0gMTApIGF2LnZlcmRpY3QgPSAnbWFsaWNpb3VzJzsKICAgICAgICBlbHNlIGlmKHB1bHNlcy5sZW5ndGggPiAwKSBhdi52ZXJkaWN0ID0gJ3N1c3BpY2lvdXMnOwogICAgICAgIGVsc2UgYXYudmVyZGljdCA9ICdzYWZlJzsKICAgICAgfQogICAgfSBjYXRjaChlKXt9CgogICAgLyogLS0tLS0tLS0tLS0tLS0tLSBGaW5hbCBWZXJkaWN0IExvZ2ljIC0tLS0tLS0tLS0tLS0tLS0gKi8KICAgICAgbGV0IG1hbGljaW91cyA9IGZhbHNlOwogICAgICBpZiAoIXZ0Rm91bmQgJiYgIW1iRm91bmQgJiYgIWF2Rm91bmQpIG1hbGljaW91cyA9IGZhbHNlOwogICAgICBlbHNlIGlmIChhdkZvdW5kICYmIGF2LnZlcmRpY3QgPT09ICdtYWxpY2lvdXMnICYmIHZ0Rm91bmQgJiYgIXZ0LmJhZCAmJiAhbWJGb3VuZCkgbWFsaWNpb3VzID0gZmFsc2U7CiAgICAgIGVsc2UgaWYgKHZ0LmJhZCB8fCBtYkZvdW5kIHx8IChhdkZvdW5kICYmIGF2LnZlcmRpY3QgPT09ICdtYWxpY2lvdXMnKSkgbWFsaWNpb3VzID0gdHJ1ZTsKICAgICAgZWxzZSBtYWxpY2lvdXMgPSBmYWxzZTsKCiAgICAvLyBzZXQgVUkgd2l0aCBub24tY29weWFibGUgZW1vamkKICAgIGxldCBlbW9qaUhUTUwgPSAnJzsKbGV0IHZlcmRpY3RUZXh0ID0gJyc7CgppZiAoIXZ0Rm91bmQgJiYgIW1iRm91bmQgJiYgIWF2Rm91bmQpIHsKICBlbW9qaUhUTUwgPSAnPHNwYW4gY2xhc3M9ImVtb2ppIG5vbmNvcHkiIGFyaWEtaGlkZGVuPSJ0cnVlIj7wn5SYPC9zcGFuPic7CiAgdmVyZGljdFRleHQgPSAnTm90IGZvdW5kJzsKfSBlbHNlIGlmIChtYWxpY2lvdXMpIHsKICBlbW9qaUhUTUwgPSAnPHNwYW4gY2xhc3M9ImVtb2ppIG5vbmNvcHkiIGFyaWEtaGlkZGVuPSJ0cnVlIj7wn5S0PC9zcGFuPic7CiAgdmVyZGljdFRleHQgPSAnTWFsaWNpb3VzJzsKfSBlbHNlIHsKICBlbW9qaUhUTUwgPSAnPHNwYW4gY2xhc3M9ImVtb2ppIG5vbmNvcHkiIGFyaWEtaGlkZGVuPSJ0cnVlIj7inIU8L3NwYW4+JzsKICB2ZXJkaWN0VGV4dCA9ICdLbm93biAvIGNsZWFuJzsKfQoKYzIuaW5uZXJIVE1MID0gYCR7ZW1vamlIVE1MfSA8c3BhbiBjbGFzcz0ic3RhdHVzLXRleHQiPiR7dmVyZGljdFRleHR9PC9zcGFuPmA7CgogICAgYzIuY2xhc3NOYW1lID0gbWFsaWNpb3VzID8gJ3JlZC10ZXh0JyA6ICdncmVlbi10ZXh0JzsKCiAgICBkYy5pbm5lckhUTUwgPSBgCiAgICAgIDxkaXY+PHNwYW4gY2xhc3M9ImsiPlZUIG5hbWU6PC9zcGFuPiR7dnRGb3VuZD9lc2NhcGVIdG1sKHZ0Lm5hbWUpOidOb3QgZm91bmQnfTwvZGl2PgogICAgICA8ZGl2PjxzcGFuIGNsYXNzPSJrIj5WVCBsYWJlbDo8L3NwYW4+JHt2dEZvdW5kP2VzY2FwZUh0bWwodnQubGFiZWwpOifigJQnfTwvZGl2PgogICAgICA8ZGl2PjxzcGFuIGNsYXNzPSJrIj5WVCBkZXRlY3Rpb25zOjwvc3Bhbj4ke3Z0Rm91bmQ/ZXNjYXBlSHRtbCh2dC5zY29yZSk6J+KAlCd9PC9kaXY+CiAgICAgIDxociBzdHlsZT0iYm9yZGVyLWNvbG9yOiMyMjIiPgogICAgICA8ZGl2PjxzcGFuIGNsYXNzPSJrIj5NQiBmaWxlOjwvc3Bhbj4ke21iRm91bmQ/ZXNjYXBlSHRtbChtYi5maWxlKTonTm90IGZvdW5kJ308L2Rpdj4KICAgICAgPGRpdj48c3BhbiBjbGFzcz0iayI+TUIgdGFnczo8L3NwYW4+JHttYkZvdW5kP2VzY2FwZUh0bWwobWIudGFncyk6J+KAlCd9PC9kaXY+CiAgICAgIDxociBzdHlsZT0iYm9yZGVyLWNvbG9yOiMyMjIiPgogICAgICA8ZGl2PjxzcGFuIGNsYXNzPSJrIj5PVFggcHVsc2VzOjwvc3Bhbj4ke2F2Rm91bmQ/ZXNjYXBlSHRtbChhdi5wdWxzZUNvdW50KTonTm90IGZvdW5kJ308L2Rpdj4KICAgICAgPGRpdj48c3BhbiBjbGFzcz0iayI+T1RYIHZlcmRpY3Q6PC9zcGFuPiR7YXZGb3VuZD9lc2NhcGVIdG1sKGF2LnZlcmRpY3QpOifigJQnfTwvZGl2PgogICAgYDsKCiAgICAvLyBhcnJvdyB0b2dnbGUgYmVoYXZpb3IKICAgIGNvbnN0IGFycm93RWwgPSBjMS5xdWVyeVNlbGVjdG9yKCcuYXJyb3cnKTsKICAgIGFycm93RWwub25jbGljayA9ICgpPT57CiAgICAgIGNvbnN0IG9wZW4gPSBkcm93LnN0eWxlLmRpc3BsYXkgPT09ICd0YWJsZS1yb3cnOwogICAgICBkcm93LnN0eWxlLmRpc3BsYXkgPSBvcGVuID8gJ25vbmUnIDogJ3RhYmxlLXJvdyc7CiAgICAgIGNvbnN0IHN5bSA9IG9wZW4gPyAn4pa2JyA6ICfilrwnOwogICAgICBhcnJvd0VsLmlubmVySFRNTCA9IGA8c3BhbiBjbGFzcz0iZW1vamkgbm9uY29weSIgYXJpYS1oaWRkZW49InRydWUiPiR7c3ltfTwvc3Bhbj5gOwogICAgfTsKCiAgICBhd2FpdCBzbGVlcChkZWxheSk7CiAgfQoKICBzZXRTdGF0dXMoJ0hhc2ggc2NhbiBjb21wbGV0ZS4nKTsKfSk7CgovKiAtLS0tLS0tLS0tLS0tLS0tLS0gQ29sbGFwc2UgLyBFeHBhbmQgYWxsIGhhc2ggZGV0YWlscyBidXR0b24gLS0tLS0tLS0tLS0tLS0tLS0tICovCmNvbnN0IHRvZ2dsZUhhc2hlc0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGVIYXNoZXNCdG4nKTsKdG9nZ2xlSGFzaGVzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsKICBjb25zdCBkZXRhaWxzID0gQXJyYXkuZnJvbShoYXNoUmVzdWx0c0JvZHkucXVlcnlTZWxlY3RvckFsbCgndHIuZGV0YWlscycpKTsKICBjb25zdCBhbnlPcGVuID0gZGV0YWlscy5zb21lKHIgPT4gci5zdHlsZS5kaXNwbGF5ID09PSAndGFibGUtcm93Jyk7CiAgY29uc3Qgd2lsbE9wZW4gPSAhYW55T3BlbjsKICBkZXRhaWxzLmZvckVhY2gociA9PiByLnN0eWxlLmRpc3BsYXkgPSB3aWxsT3BlbiA/ICd0YWJsZS1yb3cnIDogJ25vbmUnKTsKICAvLyB1cGRhdGUgYWxsIGFycm93cwogIGNvbnN0IGFycm93cyA9IEFycmF5LmZyb20oaGFzaFJlc3VsdHNCb2R5LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hcnJvdycpKTsKICBhcnJvd3MuZm9yRWFjaChhID0+IHsKICAgIGNvbnN0IHN5bSA9IHdpbGxPcGVuID8gJ+KWvCcgOiAn4pa2JzsKICAgIGEuaW5uZXJIVE1MID0gYDxzcGFuIGNsYXNzPSJlbW9qaSBub25jb3B5IiBhcmlhLWhpZGRlbj0idHJ1ZSI+JHtzeW19PC9zcGFuPmA7CiAgfSk7CiAgLy8gdXBkYXRlIGJpZyBidXR0b24gdmlzdWFsCiAgdG9nZ2xlSGFzaGVzQnRuLnNldEF0dHJpYnV0ZSgnYXJpYS1wcmVzc2VkJywgU3RyaW5nKHdpbGxPcGVuKSk7CiAgdG9nZ2xlSGFzaGVzQnRuLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nLCB3aWxsT3Blbik7CiAgLy8gdXBkYXRlIHRoZSBlbW9qaSBzaG93biBpbiB0aGUgYnV0dG9uIChrZWVwcyBpdCBub24tY29weWFibGUpCiAgdG9nZ2xlSGFzaGVzQnRuLmlubmVySFRNTCA9IGA8c3BhbiBjbGFzcz0iZW1vamkgbm9uY29weSIgYXJpYS1oaWRkZW49InRydWUiPiR7d2lsbE9wZW4gPyAn4pa8JyA6ICfilrYnfTwvc3Bhbj5gOwp9KTsKCi8qIC0tLS0tLS0tLS0tLS0tLS0tLSBJUCBzY2FubmVyIC0tLS0tLS0tLS0tLS0tLS0tLSAqLwpjb25zdCBpcFRleHRBcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lwVGV4dEFyZWEnKTsKY29uc3QgcHJpdmF0ZUlQc0FyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpdmF0ZUlQcycpOwpjb25zdCBlcnJvcmVkSVBzQXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvcmVkSVBzJyk7CmNvbnN0IHNjYW5PdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Nhbk91dHB1dCcpOwpjb25zdCBjb2xvcmVkUmVzdWx0c0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb2xvcmVkUmVzdWx0c0NvbnRhaW5lcicpOwpjb25zdCBkb3dubG9hZENTVkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkb3dubG9hZENTVkJ0bicpOwoKbGV0IGlwU2NhblJlc3VsdHMgPSBbXTsgLy8gYXJyYXkgb2YgcmVzdWx0IG9iamVjdHMgZm9yIENTViBhbmQgZmlsdGVycwoKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5JUHNCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICBjb25zdCByYXcgPSBpcFRleHRBcmVhLnZhbHVlLnRyaW0oKTsKICBpZighcmF3KXsgc2V0U3RhdHVzKCdFbnRlciBhdCBsZWFzdCBvbmUgSVAgdG8gc2NhbicsIHRydWUpOyByZXR1cm47IH0KICBjb25zdCBpcHMgPSByYXcuc3BsaXQoL1xyP1xuLykubWFwKHM9PnMudHJpbSgpKS5maWx0ZXIoQm9vbGVhbik7CiAgUFJPWFlfQkFTRSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm94eUJhc2UnKS52YWx1ZS50cmltKCk7CiAgcHJpdmF0ZUlQc0FyZWEudmFsdWUgPSAnJzsgZXJyb3JlZElQc0FyZWEudmFsdWU9Jyc7IHNjYW5PdXRwdXQudmFsdWU9Jyc7IGNvbG9yZWRSZXN1bHRzQ29udGFpbmVyLmlubmVySFRNTD0nJzsgaXBTY2FuUmVzdWx0cz1bXTsKICBkb3dubG9hZENTVkJ0bi5kaXNhYmxlZD10cnVlOwogIHNldFN0YXR1cyhgU2Nhbm5pbmcgJHtpcHMubGVuZ3RofSBJUChzKS4uLmApOwogIChhc3luYyAoKT0+IHsKICAgIGZvcihjb25zdCBpcCBvZiBpcHMpeyBhd2FpdCBwcm9jZXNzSVAoaXApOyB9CiAgICBzZXRTdGF0dXMoJ0lQIHNjYW5uaW5nIGRvbmUuJyk7CiAgICBkb3dubG9hZENTVkJ0bi5kaXNhYmxlZCA9IGlwU2NhblJlc3VsdHMubGVuZ3RoID09PSAwOwogIH0pKCk7Cn0pOwoKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NsZWFySVBzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHsKICBpcFRleHRBcmVhLnZhbHVlPScnOyBwcml2YXRlSVBzQXJlYS52YWx1ZT0nJzsgZXJyb3JlZElQc0FyZWEudmFsdWU9Jyc7IHNjYW5PdXRwdXQudmFsdWU9Jyc7IGNvbG9yZWRSZXN1bHRzQ29udGFpbmVyLmlubmVySFRNTD0nJzsgaXBTY2FuUmVzdWx0cz1bXTsgZG93bmxvYWRDU1ZCdG4uZGlzYWJsZWQ9dHJ1ZTsKfSk7Cgpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyQWxsQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IGZpbHRlcklQUmVzdWx0cygnYWxsJykpOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyTWFsaWNpb3VzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IGZpbHRlcklQUmVzdWx0cygnbWFsaWNpb3VzJykpOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyU2FmZUJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiBmaWx0ZXJJUFJlc3VsdHMoJ3NhZmUnKSk7CgpmdW5jdGlvbiBmaWx0ZXJJUFJlc3VsdHMobW9kZSl7CiAgY29uc3QgY2hpbGRyZW4gPSBBcnJheS5mcm9tKGNvbG9yZWRSZXN1bHRzQ29udGFpbmVyLmNoaWxkcmVuKTsKICBjaGlsZHJlbi5mb3JFYWNoKGVsID0+IHsKICAgIGNvbnN0IGNscyA9IGVsLmRhdGFzZXQuY2F0IHx8ICcnOwogICAgaWYobW9kZT09PSdhbGwnKSBlbC5zdHlsZS5kaXNwbGF5PSdmbGV4JzsKICAgIGVsc2UgaWYobW9kZT09PSdtYWxpY2lvdXMnKSBlbC5zdHlsZS5kaXNwbGF5ID0gKGNscz09PSdtYWxpY2lvdXNtYWxpY2lvdXMnIHx8IGNscz09PSdoaWdobHktbWFsaWNpb3VzJykgPyAnZmxleCcgOiAnbm9uZSc7CiAgICBlbHNlIGlmKG1vZGU9PT0nc2FmZScpIGVsLnN0eWxlLmRpc3BsYXkgPSAoY2xzPT09J3NhZmUnKSA/ICdmbGV4JyA6ICdub25lJzsKICB9KTsKfQoKLyogQ1NWIGVzY2FwaW5nIHBlciBSRkM0MTgwICovCmZ1bmN0aW9uIGNzdkVzY2FwZSh2YWwpewogIGlmKHZhbD09PW51bGwgfHwgdmFsPT09dW5kZWZpbmVkKSByZXR1cm4gJyc7CiAgY29uc3QgcyA9IFN0cmluZyh2YWwpOwogIGlmKC9bLCJcclxuXS8udGVzdChzKSl7CiAgICByZXR1cm4gJyInICsgcy5yZXBsYWNlKC8iL2csJyIiJykgKyAnIic7CiAgfQogIHJldHVybiBzOwp9Cgpkb3dubG9hZENTVkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4gewogIGlmKCFpcFNjYW5SZXN1bHRzIHx8IGlwU2NhblJlc3VsdHMubGVuZ3RoPT09MCkgcmV0dXJuOwogIGNvbnN0IGhlYWRlciA9IFsnaXBBZGRyZXNzJywndG90YWxSZXBvcnRzJywnYWJ1c2VDb25maWRlbmNlU2NvcmUnLCdjb3VudHJ5Q29kZScsJ2lzcCcsJ2RvbWFpbicsJ2hvc3RuYW1lJywndXNhZ2VUeXBlJ107CiAgY29uc3Qgcm93cyA9IGlwU2NhblJlc3VsdHMubWFwKHIgPT4gaGVhZGVyLm1hcChjb2wgPT4gY3N2RXNjYXBlKHJbY29sXXx8JycpKS5qb2luKCcsJykpOwogIGNvbnN0IGNzdiA9IFtoZWFkZXIuam9pbignLCcpLCAuLi5yb3dzXS5qb2luKCdcclxuJyk7CiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjc3ZdLCB7IHR5cGU6J3RleHQvY3N2O2NoYXJzZXQ9dXRmLTg7JyB9KTsKICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogIGxpbmsuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgbGluay5kb3dubG9hZCA9IGAke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfV9hYnVzZWlwZGJfc2Nhbi5jc3ZgOwogIGxpbmsuY2xpY2soKTsKfSk7CgovKiBJUCBoZWxwZXJzICovCmZ1bmN0aW9uIGlzUHJpdmF0ZUlQKGlwKXsKICByZXR1cm4gL14oMTBcLlxkezEsM31cLlxkezEsM31cLlxkezEsM318MTkyXC4xNjhcLlxkezEsM31cLlxkezEsM318MTcyXC4oMVs2LTldfDJbMC05XXwzWzAtMV0pXC5cZHsxLDN9XC5cZHsxLDN9KSQvLnRlc3QoaXApOwp9Cgphc3luYyBmdW5jdGlvbiBwcm9jZXNzSVAoaXApewogIGlmKGlzUHJpdmF0ZUlQKGlwKSl7CiAgICBwcml2YXRlSVBzQXJlYS52YWx1ZSArPSBpcCArICdcbic7CiAgICByZXR1cm47CiAgfQogIHRyeSB7CiAgICBjb25zdCByZXMgPSBhd2FpdCBjaGVja0lQKGlwKTsKICAgIHNjYW5PdXRwdXQudmFsdWUgKz0gcmVzLnRleHQgKyAnXG4nOwogICAgLy8gU2hvdyBjb3VudHJ5IGZsYWcgaW5zdGVhZCBvZiByYXcgY29kZQogICAgY29uc3QgZmxhZyA9IHJlcy5kYXRhPy5jb3VudHJ5Q29kZSA/IHRvRmxhZ0Vtb2ppKHJlcy5kYXRhLmNvdW50cnlDb2RlKSA6ICcnOwogICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBkaXYuY2xhc3NOYW1lID0gJ3Jlc3VsdCAnICsgcmVzLmNsYXNzTmFtZTsKICAgIGRpdi5kYXRhc2V0LmNhdCA9IHJlcy5jbGFzc05hbWU7CiAgICBkaXYuaW5uZXJIVE1MID0gYDxkaXYgc3R5bGU9ImZsZXg6MSI+JHtlc2NhcGVIdG1sKHJlcy50ZXh0KX08L2Rpdj48ZGl2IGNsYXNzPSJzbWFsbCIgdGl0bGU9IiR7ZXNjYXBlSHRtbChyZXMuZGF0YT8uY291bnRyeUNvZGV8fCcnKX0iPiR7ZmxhZ308L2Rpdj5gOwogICAgY29sb3JlZFJlc3VsdHNDb250YWluZXIuYXBwZW5kQ2hpbGQoZGl2KTsKICAgIGlmKHJlcy5kYXRhKXsKICAgICAgaXBTY2FuUmVzdWx0cy5wdXNoKHsKICAgICAgICBpcEFkZHJlc3M6IHJlcy5kYXRhLmlwQWRkcmVzc3x8aXAsCiAgICAgICAgdG90YWxSZXBvcnRzOiByZXMuZGF0YS50b3RhbFJlcG9ydHN8fDAsCiAgICAgICAgYWJ1c2VDb25maWRlbmNlU2NvcmU6IHJlcy5kYXRhLmFidXNlQ29uZmlkZW5jZVNjb3JlfHwwLAogICAgICAgIGNvdW50cnlDb2RlOiByZXMuZGF0YS5jb3VudHJ5Q29kZXx8JycsCiAgICAgICAgaXNwOiByZXMuZGF0YS5pc3B8fCcnLAogICAgICAgIGRvbWFpbjogcmVzLmRhdGEuZG9tYWlufHwnJywKICAgICAgICBob3N0bmFtZTogcmVzLmRhdGEuaG9zdG5hbWV8fCcnLAogICAgICAgIHVzYWdlVHlwZTogcmVzLmRhdGEudXNhZ2VUeXBlfHwnJywKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBpcFNjYW5SZXN1bHRzLnB1c2goewogICAgICAgIGlwQWRkcmVzczogaXAsIHRvdGFsUmVwb3J0czonJywgYWJ1c2VDb25maWRlbmNlU2NvcmU6JycsIGNvdW50cnlDb2RlOicnLCBpc3A6JycsIGRvbWFpbjonJywgaG9zdG5hbWU6JycsIHVzYWdlVHlwZTonJwogICAgICB9KTsKICAgICAgZXJyb3JlZElQc0FyZWEudmFsdWUgKz0gaXAgKyAnXG4nOwogICAgfQogIH0gY2F0Y2goZXJyKXsKICAgIGVycm9yZWRJUHNBcmVhLnZhbHVlICs9IGlwICsgJ1xuJzsKICAgIHNjYW5PdXRwdXQudmFsdWUgKz0gYElQOiAke2lwfSAtIEVycm9yOiAke2Vyci5tZXNzYWdlfVxuYDsKICB9Cn0KCi8qIG5ldHdvcmsgY2FsbCB0byBBYnVzZUlQREIgdmlhIFdvcmtlciBwcm94eSAobm8gY2xpZW50IGtleSkgKi8KYXN5bmMgZnVuY3Rpb24gY2hlY2tJUChpcCl7CiAgY29uc3QgYXBpVXJsID0gYGh0dHBzOi8vYXBpLmFidXNlaXBkYi5jb20vYXBpL3YyL2NoZWNrP2lwQWRkcmVzcz0ke2VuY29kZVVSSUNvbXBvbmVudChpcCl9YDsKICBjb25zdCBwcm94aWVkID0gYnVpbGRQcm94aWVkVXJsKGFwaVVybCk7CiAgdHJ5IHsKICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2gocHJveGllZCwgeyBtZXRob2Q6J0dFVCcsIGhlYWRlcnM6IHsgJ0FjY2VwdCc6J2FwcGxpY2F0aW9uL2pzb24nIH19KTsKICAgIGlmKCFyZXNwb25zZS5vayl7CiAgICAgIHJldHVybiB7IHRleHQ6IGBJUDogJHtpcH0gLSBFcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gLCBjbGFzc05hbWU6J2ludmFsaWQnLCBkYXRhOm51bGwgfTsKICAgIH0KICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CiAgICBjb25zdCBkID0gZGF0YS5kYXRhIHx8IG51bGw7CiAgICBpZighZCkgcmV0dXJuIHsgdGV4dDogYElQOiAke2lwfSAtIEludmFsaWQgcmVzcG9uc2VgLCBjbGFzc05hbWU6J2ludmFsaWQnLCBkYXRhOm51bGwgfTsKICAgIGNvbnN0IHsgaXBBZGRyZXNzLCBhYnVzZUNvbmZpZGVuY2VTY29yZSwgdG90YWxSZXBvcnRzLCBjb3VudHJ5Q29kZSwgaXNwIH0gPSBkOwogICAgaWYoYWJ1c2VDb25maWRlbmNlU2NvcmUgPj0gODApewogICAgICByZXR1cm4geyB0ZXh0OmBUaGUgSVAgJHtpcEFkZHJlc3N9IGlzIGhpZ2hseSBtYWxpY2lvdXMgKENvbmZpZGVuY2U6ICR7YWJ1c2VDb25maWRlbmNlU2NvcmV9JSwgUmVwb3J0czogJHt0b3RhbFJlcG9ydHN9LCBJU1A6ICR7aXNwfSwgJHtjb3VudHJ5Q29kZX0pYCwgY2xhc3NOYW1lOidoaWdobHktbWFsaWNpb3VzJywgZGF0YTpkIH07CiAgICB9IGVsc2UgaWYoYWJ1c2VDb25maWRlbmNlU2NvcmUgPj0gNSl7CiAgICAgIHJldHVybiB7IHRleHQ6YFRoZSBJUCAke2lwQWRkcmVzc30gaXMgbWFsaWNpb3VzIChDb25maWRlbmNlOiAke2FidXNlQ29uZmlkZW5jZVNjb3JlfSUsIFJlcG9ydHM6ICR7dG90YWxSZXBvcnRzfSwgSVNQOiAke2lzcH0sICR7Y291bnRyeUNvZGV9KWAsIGNsYXNzTmFtZTonbWFsaWNpb3VzJywgZGF0YTpkIH07CiAgICB9IGVsc2UgewogICAgICByZXR1cm4geyB0ZXh0OmBUaGUgSVAgJHtpcEFkZHJlc3N9IGlzIHNhZmUgYW5kIGl0IGJlbG9uZ3MgdG8gSVNQICR7aXNwfSwgJHtjb3VudHJ5Q29kZX1gLCBjbGFzc05hbWU6J3NhZmUnLCBkYXRhOmQgfTsKICAgIH0KICB9IGNhdGNoKGVycil7CiAgICByZXR1cm4geyB0ZXh0OiBgSVA6ICR7aXB9IC0gRXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCwgY2xhc3NOYW1lOidpbnZhbGlkJywgZGF0YTpudWxsIH07CiAgfQp9CgovKiAtLS0tLS0tLS0tLS0tLS0tLS0gVVJMIHNjYW5uZXIgKHJldXNlZDogcmVzdWx0cy1vbmx5IGFyZWEpIC0tLS0tLS0tLS0tLS0tLS0tLSAqLwovLyBSRVBMQUNFIHRoZSBvbGQgc2NhblVSTCgpIHdpdGggdGhpcyBmdW5jdGlvbgphc3luYyBmdW5jdGlvbiBzY2FuVVJMKHVybCl7CiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgY29udGFpbmVyLmNsYXNzTmFtZSA9ICdzdW1tYXJ5JzsKICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxzdHJvbmc+JHtlc2NhcGVIdG1sKHVybCl9PC9zdHJvbmc+IOKAlCBjaGVja2luZy4uLmA7CiAgdXJsT3V0cHV0LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7CgogIC8vIFRyYWNrIGJhc2ljIFVSTCB2ZXJkaWN0IGluZm8KICBsZXQgdXJsRm91bmQgPSBmYWxzZTsKICBsZXQgdXJsTWFsaWNpb3VzID0gZmFsc2U7CiAgbGV0IHVybFN1c3BpY2lvdXMgPSBmYWxzZTsKICBsZXQgdXJsVG90YWxzID0gMDsKCiAgdHJ5IHsKICAgIC8vIFN0ZXAgMTogUE9TVCB0aGUgVVJMIHRvIFZUIHRvIGNyZWF0ZSBhbiBhbmFseXNpcwogICAgY29uc3QgdnRQb3N0VXJsID0gYGh0dHBzOi8vd3d3LnZpcnVzdG90YWwuY29tL2FwaS92My91cmxzYDsKICAgIGNvbnN0IHByb3hpZWRQb3N0VXJsID0gYnVpbGRQcm94aWVkVXJsKHZ0UG9zdFVybCk7CgogICAgY29uc3QgcG9zdFJlcyA9IGF3YWl0IGZldGNoKHByb3hpZWRQb3N0VXJsLCB7CiAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICBoZWFkZXJzOiB7ICdBY2NlcHQnOidhcHBsaWNhdGlvbi9qc29uJywgJ0NvbnRlbnQtVHlwZSc6J2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgfSwKICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7IHVybDogdXJsIH0pCiAgICB9KTsKCiAgICBpZiAocG9zdFJlcy5vaykgewogICAgICBjb25zdCBwb3N0SnNvbiA9IGF3YWl0IHBvc3RSZXMuanNvbigpLmNhdGNoKCgpPT5udWxsKTsKICAgICAgY29uc3QgYW5hbHlzaXNJZCA9IHBvc3RKc29uPy5kYXRhPy5pZDsKICAgICAgaWYgKGFuYWx5c2lzSWQpIHsKICAgICAgICAvLyBQb2xsIHRoZSBhbmFseXNpcyB1bnRpbCBjb21wbGV0ZWQgKG9yIHRpbWVvdXQpCiAgICAgICAgY29uc3QgdnRBbmFseXNpc1VybCA9IGBodHRwczovL3d3dy52aXJ1c3RvdGFsLmNvbS9hcGkvdjMvYW5hbHlzZXMvJHthbmFseXNpc0lkfWA7CiAgICAgICAgY29uc3QgcHJveGllZEFuYWx5c2lzVXJsID0gYnVpbGRQcm94aWVkVXJsKHZ0QW5hbHlzaXNVcmwpOwogICAgICAgIGNvbnN0IG1heFRyaWVzID0gODsKICAgICAgICBmb3IgKGxldCBpPTA7aTxtYXhUcmllcztpKyspewogICAgICAgICAgY29uc3QgZ2V0UmVzID0gYXdhaXQgZmV0Y2gocHJveGllZEFuYWx5c2lzVXJsLCB7IG1ldGhvZDonR0VUJywgaGVhZGVyczp7ICdBY2NlcHQnOidhcHBsaWNhdGlvbi9qc29uJyB9fSk7CiAgICAgICAgICBpZighZ2V0UmVzLm9rKXsKICAgICAgICAgICAgLy8gaWYgZmV0Y2ggZmFpbHMsIGJyZWFrIGFuZCB0cmVhdCBhcyBub3QtZm91bmQgZm9yIFVSTCAod2UnbGwgY2hlY2sgZG9tYWluIGxhdGVyKQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGogPSBhd2FpdCBnZXRSZXMuanNvbigpLmNhdGNoKCgpPT5udWxsKTsKICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IGo/LmRhdGE/LmF0dHJpYnV0ZXM/LnN0YXR1czsKICAgICAgICAgIGlmIChzdGF0dXMgPT09ICdjb21wbGV0ZWQnKSB7CiAgICAgICAgICAgIGNvbnN0IHN0YXRzID0gai5kYXRhLmF0dHJpYnV0ZXMuc3RhdHMgfHwge307CiAgICAgICAgICAgIGNvbnN0IG0gPSBzdGF0cy5tYWxpY2lvdXMgfHwgMDsKICAgICAgICAgICAgY29uc3QgcyA9IHN0YXRzLnN1c3BpY2lvdXMgfHwgMDsKICAgICAgICAgICAgY29uc3QgaCA9IHN0YXRzLmhhcm1sZXNzIHx8IDA7CiAgICAgICAgICAgIHVybEZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgdXJsTWFsaWNpb3VzID0gbSA+IDA7CiAgICAgICAgICAgIHVybFN1c3BpY2lvdXMgPSBzID4gMDsKICAgICAgICAgICAgdXJsVG90YWxzID0gbSArIHMgKyBoOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGF3YWl0IHNsZWVwKDcwMCk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBub24tT0sgUE9TVDogcHJlc2VydmUgZm9yIGRpYWdub3N0aWNzICh3ZSB3aWxsIHN0aWxsIGF0dGVtcHQgZG9tYWluIGlmIFVSTCBub3QgbWFsaWNpb3VzKQogICAgICAvLyBvcHRpb25hbDogeW91IGNvdWxkIHJlYWQgZXJyb3IgYm9keSBoZXJlIGlmIHlvdSB3YW50IHRvIGRpc3BsYXkgZXJyb3IgZm9yIFVSTAogICAgfQogIH0gY2F0Y2ggKGUpIHsKICAgIC8vIG5ldHdvcmsvb3RoZXI6IGlnbm9yZSBoZXJlIGFuZCBjb250aW51ZSB0byBkb21haW4gcGF0aCBpZiBhcHByb3ByaWF0ZQogICAgY29uc29sZS5kZWJ1Zygnc2NhblVSTDogVVJMIGFuYWx5c2lzIGVycm9yJywgZSk7CiAgfQoKICAvLyBJZiBVUkwgaXMgbWFsaWNpb3VzIC0+IHNob3cgVVJMIG1hbGljaW91cyBhbmQgc2tpcCBkb21haW4gZW50aXJlbHkKICBjb25zdCBkZWZhbmdlZCA9IHVybC5yZXBsYWNlKC9cLi9nLCdbLl0nKTsKICBpZiAodXJsTWFsaWNpb3VzKSB7CiAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgncmVkJyk7CiAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxzdHJvbmc+JHtlc2NhcGVIdG1sKGRlZmFuZ2VkKX08L3N0cm9uZz4g4oCUIPCflLQgTWFsaWNpb3VzIChVUkwgdmVyZGljdClgOwogICAgLy8gKERvIG5vdCBjaGVjayBkb21haW4gcGVyIHlvdXIgcmVxdWlyZW1lbnQpCiAgICByZXR1cm47CiAgfQoKICAvLyBJZiBVUkwgaXMgc2FmZSBvciBub3QgZm91bmQgLT4gZXh0cmFjdCBkb21haW4gYW5kIGNoZWNrIGl0CiAgbGV0IGRvbWFpbiA9IG51bGw7CiAgdHJ5IHsgZG9tYWluID0gZXh0cmFjdEhvc3RQcmVmZXIodXJsKTsgfSBjYXRjaChlKXsgZG9tYWluID0gbnVsbDsgfQoKICBpZiAoIWRvbWFpbikgewogICAgLy8gTm8gcGFyc2VhYmxlIGhvc3Q6IHNob3cgVVJMIHZlcmRpY3QgKHNhZmUvbm90IGZvdW5kKQogICAgaWYgKHVybEZvdW5kKSB7CiAgICAgIGlmICh1cmxTdXNwaWNpb3VzKSB7CiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3llbGxvdycpOwogICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzY2FwZUh0bWwoZGVmYW5nZWQpfTwvc3Ryb25nPiDigJQgU3VzcGljaW91c2A7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2dyZWVuJyk7CiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGA8c3Ryb25nPiR7ZXNjYXBlSHRtbChkZWZhbmdlZCl9PC9zdHJvbmc+IOKAlCBOb3QgZmxhZ2dlZCAvIFNhZmVgOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBVUkwgbm90IGZvdW5kIGFuZCBubyBkb21haW4g4oCUIHNob3cgIk5vdCBmb3VuZCIgdmlzdWFsbHkgKPCflJgpIGJ1dCBkb24ndCBwZXJmb3JtIGRvbWFpbiBjaGVja3MKICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3llbGxvdycpOwogICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxzdHJvbmc+JHtlc2NhcGVIdG1sKGRlZmFuZ2VkKX08L3N0cm9uZz4g4oCUIPCflJggTm90IGZvdW5kYDsKICAgIH0KICAgIHJldHVybjsKICB9CgogIC8vIFF1ZXJ5IGRvbWFpbiBvbmx5IHdoZW4gVVJMIHdhc24ndCBtYWxpY2lvdXMKICBsZXQgZG9tYWluTWFsaWNpb3VzID0gZmFsc2U7CiAgdHJ5IHsKICAgIGNvbnN0IHZ0RG9tYWluVXJsID0gYnVpbGRQcm94aWVkVXJsKGBodHRwczovL3d3dy52aXJ1c3RvdGFsLmNvbS9hcGkvdjMvZG9tYWlucy8ke2VuY29kZVVSSUNvbXBvbmVudChkb21haW4pfWApOwogICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godnREb21haW5VcmwsIHsgbWV0aG9kOidHRVQnLCBoZWFkZXJzOnsgJ0FjY2VwdCc6J2FwcGxpY2F0aW9uL2pzb24nIH19KTsKICAgIGlmIChyZXMub2spIHsKICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlcy5qc29uKCkuY2F0Y2goKCk9Pm51bGwpOwogICAgICBjb25zdCBzdGF0cyA9IGRhdGE/LmRhdGE/LmF0dHJpYnV0ZXM/Lmxhc3RfYW5hbHlzaXNfc3RhdHMgfHwge307CiAgICAgIGNvbnN0IG0gPSBzdGF0cy5tYWxpY2lvdXMgfHwgMDsKICAgICAgY29uc3QgcyA9IHN0YXRzLnN1c3BpY2lvdXMgfHwgMDsKICAgICAgY29uc3QgaCA9IHN0YXRzLmhhcm1sZXNzIHx8IDA7CiAgICAgIGRvbWFpbk1hbGljaW91cyA9IG0gPiAwOwogICAgICAvLyBJZiBkb21haW4gbWFsaWNpb3VzLCB1cGRhdGUgdGhlIHNhbWUgVVJMIGNvbnRhaW5lciB0byByZWZsZWN0IGRvbWFpbiB2ZXJkaWN0CiAgICAgIGlmIChkb21haW5NYWxpY2lvdXMpIHsKICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgneWVsbG93JywnZ3JlZW4nKTsKICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgncmVkJyk7CiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGA8c3Ryb25nPiR7ZXNjYXBlSHRtbChkZWZhbmdlZCl9PC9zdHJvbmc+IOKAlCDwn5S0IE1hbGljaW91cyAoRG9tYWluIHZlcmRpY3QpYDsKICAgICAgICAvLyBBdHRhY2ggdGhlIGRvbWFpbiB3aWRnZXQgdG8gdGhlIHNhbWUgVVJMIHJlc3VsdCAobm8gc2VwYXJhdGUgZG9tYWluIHJlc3VsdCkKICAgICAgICBjb25zdCB3aWRnZXRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICB3aWRnZXRCdG4udGV4dENvbnRlbnQgPSAnU2hvdyBEb21haW4gV2lkZ2V0JzsKICAgICAgICB3aWRnZXRCdG4uc3R5bGUubWFyZ2luTGVmdCA9ICc4cHgnOwogICAgICAgIHdpZGdldEJ0bi5vbmNsaWNrID0gKCkgPT4gdG9nZ2xlV2lkZ2V0KGRvbWFpbiwgd2lkZ2V0QnRuKTsKICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQod2lkZ2V0QnRuKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gRG9tYWluIG5vdCBtYWxpY2lvdXMg4oCUIGxlYXZlIFVSTCB2ZXJkaWN0IChzYWZlL25vdCBmb3VuZCkgYXMtaXMsIGRvIG5vdCBjcmVhdGUgYSBzZXBhcmF0ZSBkb21haW4gZWxlbWVudAogICAgICAgIGlmICh1cmxGb3VuZCkgewogICAgICAgICAgaWYgKHVybFN1c3BpY2lvdXMpIHsKICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3llbGxvdycpOwogICAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxzdHJvbmc+JHtlc2NhcGVIdG1sKGRlZmFuZ2VkKX08L3N0cm9uZz4g4oCUIFN1c3BpY2lvdXNgOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2dyZWVuJyk7CiAgICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzY2FwZUh0bWwoZGVmYW5nZWQpfTwvc3Ryb25nPiDigJQgTm90IGZsYWdnZWQgLyBTYWZlYDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2dyZWVuJyk7CiAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxzdHJvbmc+JHtlc2NhcGVIdG1sKGRlZmFuZ2VkKX08L3N0cm9uZz4g4oCUIE5vdCBmbGFnZ2VkIC8gU2FmZWA7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gRG9tYWluIHF1ZXJ5IGZhaWxlZDoganVzdCBzaG93IFVSTCB2ZXJkaWN0IChwcmVmZXIgc2FmZSBwcmVzZW50YXRpb24pCiAgICAgIGlmICh1cmxGb3VuZCkgewogICAgICAgIGlmICh1cmxTdXNwaWNpb3VzKSB7CiAgICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgneWVsbG93Jyk7CiAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxzdHJvbmc+JHtlc2NhcGVIdG1sKGRlZmFuZ2VkKX08L3N0cm9uZz4g4oCUIFN1c3BpY2lvdXNgOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgnZ3JlZW4nKTsKICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzY2FwZUh0bWwoZGVmYW5nZWQpfTwvc3Ryb25nPiDigJQgTm90IGZsYWdnZWQgLyBTYWZlYDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3llbGxvdycpOwogICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzY2FwZUh0bWwoZGVmYW5nZWQpfTwvc3Ryb25nPiDigJQg8J+UmCBOb3QgZm91bmRgOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICB9IGNhdGNoIChlKSB7CiAgICAvLyBPbiBlcnJvciBjaGVja2luZyBkb21haW46IGZhbGwgYmFjayB0byBVUkwgdmVyZGljdAogICAgaWYgKHVybEZvdW5kKSB7CiAgICAgIGlmICh1cmxTdXNwaWNpb3VzKSB7CiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3llbGxvdycpOwogICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzY2FwZUh0bWwoZGVmYW5nZWQpfTwvc3Ryb25nPiDigJQgU3VzcGljaW91c2A7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2dyZWVuJyk7CiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGA8c3Ryb25nPiR7ZXNjYXBlSHRtbChkZWZhbmdlZCl9PC9zdHJvbmc+IOKAlCBOb3QgZmxhZ2dlZCAvIFNhZmVgOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgneWVsbG93Jyk7CiAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzY2FwZUh0bWwoZGVmYW5nZWQpfTwvc3Ryb25nPiDigJQg8J+UmCBOb3QgZm91bmRgOwogICAgfQogICAgcmV0dXJuOwogIH0KfQoKCgovLyBleHRyYWN0IGhvc3QgaGVscGVyICh1bmNoYW5nZWQpCmZ1bmN0aW9uIGV4dHJhY3RIb3N0UHJlZmVyKHMpewogIGlmKCFzKSByZXR1cm4gbnVsbDsKICB0cnl7CiAgICBsZXQgcGFyc2VkOwogICAgaWYoL15bYS16QS1aXVthLXpBLVowLTkrXC0uXSo6XC9cLy8udGVzdChzKSkgcGFyc2VkID0gbmV3IFVSTChzKTsKICAgIGVsc2UgcGFyc2VkID0gbmV3IFVSTCgnaHR0cDovLycrcyk7CiAgICBsZXQgaG9zdCA9IHBhcnNlZC5ob3N0bmFtZSB8fCBudWxsOwogICAgaWYoaG9zdCkgaG9zdCA9IGNsZWFuSG9zdChob3N0KTsKICAgIHJldHVybiBob3N0OwogIH0gY2F0Y2goZSl7CiAgICBjb25zdCBwYXJ0cyA9IHMuc3BsaXQoJy8nKTsKICAgIGlmKHBhcnRzLmxlbmd0aD4wKSByZXR1cm4gY2xlYW5Ib3N0KHBhcnRzWzBdKTsKICAgIHJldHVybiBudWxsOwogIH0KfQoKLyogLS0tLS0tLS0tLS0tLS0tLS0tIFdpZGdldCBsb2FkZXIgKHJldXNlZCkgLS0tLS0tLS0tLS0tLS0tLS0tICovCmFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVdpZGdldChkb21haW4sIGJ1dHRvbil7CiAgY29uc3QgaWZyYW1lSWQgPSAndnQtd2lkZ2V0LScgKyBlbmNvZGVVUklDb21wb25lbnQoZG9tYWluKTsKICBjb25zdCBleGlzdGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlmcmFtZUlkKTsKICBpZihleGlzdGluZyl7IGNvbnN0IGhpZGRlbiA9IGV4aXN0aW5nLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJzsgZXhpc3Rpbmcuc3R5bGUuZGlzcGxheSA9IGhpZGRlbiA/ICdibG9jaycgOiAnbm9uZSc7IGJ1dHRvbi50ZXh0Q29udGVudCA9IGhpZGRlbiA/ICdIaWRlIFdpZGdldCcgOiAnU2hvdyBXaWRnZXQnOyByZXR1cm47IH0KICB0cnkgewogICAgY29uc3QgdG9rZW5VcmwgPSBgaHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vYXBpL3YzL3dpZGdldC91cmw/cXVlcnk9JHtlbmNvZGVVUklDb21wb25lbnQoZG9tYWluKX1gOwogICAgY29uc3QgcHJveGllZFRva2VuVXJsID0gYnVpbGRQcm94aWVkVXJsKHRva2VuVXJsKTsKICAgIGNvbnN0IHRSZXMgPSBhd2FpdCBmZXRjaChwcm94aWVkVG9rZW5VcmwsIHsgbWV0aG9kOidHRVQnLCBoZWFkZXJzOnsgJ0FjY2VwdCc6J2FwcGxpY2F0aW9uL2pzb24nIH19KTsKICAgIGlmKCF0UmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoJ1Rva2VuIHJlcXVlc3QgZmFpbGVkOiAnICsgdFJlcy5zdGF0dXMpOwogICAgY29uc3QgdEpzb24gPSBhd2FpdCB0UmVzLmpzb24oKTsKICAgIGNvbnN0IHJlbW90ZVVybCA9IHRKc29uPy5kYXRhPy51cmw7IGlmKCFyZW1vdGVVcmwpIHRocm93IG5ldyBFcnJvcignTm8gdG9rZW4gcmV0dXJuZWQnKTsKICAgIGNvbnN0IHRva2VuID0gcmVtb3RlVXJsLnNwbGl0KCcvdWkvd2lkZ2V0L2h0bWwvJylbMV07IGlmKCF0b2tlbikgdGhyb3cgbmV3IEVycm9yKCdCYWQgdG9rZW4gZm9ybWF0Jyk7CiAgICBjb25zdCB3aWRnZXRIdG1sVXJsID0gYGh0dHBzOi8vd3d3LnZpcnVzdG90YWwuY29tL3VpL3dpZGdldC9odG1sLyR7dG9rZW59YDsKICAgIGNvbnN0IHByb3hpZWRIdG1sID0gYnVpbGRQcm94aWVkVXJsKHdpZGdldEh0bWxVcmwpOwogICAgY29uc3Qgd1JlcyA9IGF3YWl0IGZldGNoKHByb3hpZWRIdG1sLCB7IG1ldGhvZDonR0VUJywgaGVhZGVyczp7ICdBY2NlcHQnOid0ZXh0L2h0bWwnIH19KTsKICAgIGlmKCF3UmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoJ1dpZGdldCBIVE1MIGZldGNoIGZhaWxlZDogJyArIHdSZXMuc3RhdHVzKTsKICAgIGNvbnN0IHdpZGdldEh0bWwgPSBhd2FpdCB3UmVzLnRleHQoKTsKICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOyBpZnJhbWUuaWQ9aWZyYW1lSWQ7IGlmcmFtZS5jbGFzc05hbWU9J3dpZGdldC1pZnJhbWUnOyBpZnJhbWUuc3JjZG9jID0gd2lkZ2V0SHRtbDsgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpOwogICAgYnV0dG9uLnRleHRDb250ZW50PSdIaWRlIFdpZGdldCc7CiAgfSBjYXRjaChlcnIpewogICAgYWxlcnQoJ1dpZGdldCBlcnJvcjogJyArIGVyci5tZXNzYWdlKTsKICB9Cn0KCi8qIC0tLS0tLS0tLS0tLS0tLS0tLSBXb3JrZXIgdGVzdCAtLS0tLS0tLS0tLS0tLS0tLS0gKi8KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlc3RXb3JrZXJCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpPT57CiAgUFJPWFlfQkFTRSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm94eUJhc2UnKS52YWx1ZS50cmltKCk7CiAgaWYoIVBST1hZX0JBU0UpIHJldHVybiBzZXRTdGF0dXMoJ1NldCBQUk9YWV9CQVNFIGZpcnN0JywgdHJ1ZSk7CiAgc2V0U3RhdHVzKCdUZXN0aW5nIHdvcmtlciB3aXRoIHZpcnVzdG90YWwuY29tIGRvbWFpbiBleGFtcGxlLi4uJyk7CiAgdHJ5IHsKICAgIGNvbnN0IHZ0VXJsID0gJ2h0dHBzOi8vd3d3LnZpcnVzdG90YWwuY29tL2FwaS92My9kb21haW5zL2V4YW1wbGUuY29tJzsKICAgIGNvbnN0IHByb3hpZWQgPSBidWlsZFByb3hpZWRVcmwodnRVcmwpOwogICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2gocHJveGllZCx7bWV0aG9kOidHRVQnLCBoZWFkZXJzOnsnQWNjZXB0JzonYXBwbGljYXRpb24vanNvbid9fSk7CiAgICBpZighcmVzLm9rKXsgc2V0U3RhdHVzKGBXb3JrZXIgdGVzdCBmYWlsZWQ6ICR7cmVzLnN0YXR1c31gLCB0cnVlKTsgY29uc29sZS5lcnJvcihhd2FpdCByZXMudGV4dCgpLmNhdGNoKCgpPT5yZXMuc3RhdHVzVGV4dCkpOyByZXR1cm47IH0KICAgIHNldFN0YXR1cygnV29ya2VyIHRlc3Qgc3VjY2VlZGVkIChWVCBkb21haW4gZmV0Y2ggcmV0dXJuZWQgMjAwKS4nKTsKICB9IGNhdGNoKGVycil7IHNldFN0YXR1cygnV29ya2VyIHRlc3QgZXJyb3I6ICcgKyBlcnIubWVzc2FnZSwgdHJ1ZSk7IH0KfSk7CgovKiBpbml0aWFsIHN5bmMgKi8KUFJPWFlfQkFTRSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm94eUJhc2UnKS52YWx1ZS50cmltKCk7CnNldFN0YXR1cygnUmVhZHkuJyk7Cjwvc2NyaXB0PgoKPC9ib2R5Pgo8L2h0bWw+Cg=="))));</script>
